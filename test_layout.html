<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sprint Todo App - Layout Test</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="app.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="logo">
                <i class="fas fa-tasks"></i>
                <h1>Sprint Todo</h1>
            </div>
            <nav class="main-nav">
                <button class="nav-btn active" data-view="backlog">
                    <i class="fas fa-list"></i> Backlog
                </button>
                <button class="nav-btn" data-view="board">
                    <i class="fas fa-columns"></i> Board
                </button>
                <button class="nav-btn" data-view="charts">
                    <i class="fas fa-chart-bar"></i> Charts
                </button>
            </nav>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <div class="content-area">
                <!-- Backlog View -->
                <div id="backlog-view" class="view active">
                    <div class="backlog-header">
                        <h2>Task Backlog</h2>
                        <div class="backlog-actions">
                            <button id="add-task-btn" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Add Task
                            </button>
                            <button id="add-to-backlog-btn" class="btn btn-secondary">
                                <i class="fas fa-plus"></i> Add to Backlog
                            </button>
                        </div>
                    </div>

                    <!-- Sidebar -->
                    <div class="sidebar">
                        <div class="sidebar-section">
                            <h3>Folders</h3>
                            <div class="folder-list" id="folder-list">
                                <!-- Folders will be rendered here -->
                            </div>
                            <button id="create-folder-btn" class="btn btn-sm btn-secondary">
                                <i class="fas fa-folder-plus"></i> New Folder
                            </button>
                        </div>
                    </div>

                    <!-- Task Table -->
                    <div class="task-table-container">
                        <div class="task-table-header">
                            <h3>Tasks</h3>
                            <button id="add-task-to-folder-btn" class="btn btn-sm btn-primary">
                                <i class="fas fa-plus"></i> Add Task to Folder
                            </button>
                        </div>
                        <table class="task-table">
                            <thead>
                                <tr>
                                    <th>Complete</th>
                                    <th>Task</th>
                                    <th>Points</th>
                                    <th>Priority</th>
                                    <th>Due Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="task-table-body">
                                <!-- Tasks will be rendered here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Task Modal -->
    <div id="task-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="task-modal-title">Add New Task</h3>
                <span class="close">&times;</span>
            </div>
            <form id="task-form">
                <input type="hidden" id="task-id">
                <div class="form-group">
                    <label for="task-title">Title *</label>
                    <input type="text" id="task-title" required>
                </div>
                <div class="form-group">
                    <label for="task-description">Description</label>
                    <textarea id="task-description" rows="3"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-points">Points</label>
                        <input type="number" id="task-points" min="1" value="1">
                    </div>
                    <div class="form-group">
                        <label for="task-priority">Priority</label>
                        <select id="task-priority">
                            <option value="low">Low</option>
                            <option value="medium" selected>Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-due-date">Due Date</label>
                        <input type="date" id="task-due-date">
                    </div>
                    <div class="form-group">
                        <label for="task-sprint">Sprint</label>
                        <select id="task-sprint">
                            <option value="">No Sprint</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="task-recurring"> Recurring Task
                    </label>
                </div>
                <div class="form-group" id="recurring-options" style="display: none;">
                    <label for="recurring-type">Recurring Type</label>
                    <select id="recurring-type">
                        <option value="daily">Daily</option>
                        <option value="weekly">Weekly</option>
                        <option value="monthly">Monthly</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Save Task</button>
                    <button type="button" class="btn btn-secondary" onclick="window.app.closeTaskModal()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Test script for Sprint Todo App new layout functionality
        console.log('Testing Sprint Todo App new layout functionality...');

        // Check if the app is loaded
        if (typeof window.app === 'undefined') {
            console.error('❌ App not loaded');
        } else {
            console.log('✅ App loaded successfully');

            // Test key methods
            const requiredMethods = [
                'renderTasks',
                'createTaskTableRow',
                'selectFolder',
                'openTaskModal',
                'closeTaskModal',
                'saveTask',
                'openInlineTaskForm',
                'closeInlineTaskForm',
                'createInlineTask',
                'toggleSubtaskComplete',
                'toggleSubtasks',
                'updateTaskPriority',
                'updateTaskPoints',
                'assignTaskToSprint',
                'editTask',
                'deleteTask',
                'showNotification'
            ];

            let allMethodsExist = true;
            requiredMethods.forEach(method => {
                if (typeof window.app[method] !== 'function') {
                    console.error(`❌ Method ${method} not found`);
                    allMethodsExist = false;
                } else {
                    console.log(`✅ Method ${method} exists`);
                }
            });

            if (allMethodsExist) {
                console.log('✅ All required methods exist');

                // Test creating a folder
                const folderData = { name: 'Test Folder' };
                const newFolder = window.app.createFolder(folderData);
                if (newFolder && newFolder.id) {
                    console.log('✅ Folder creation works');
                    
                    // Test creating a task
                    const taskData = {
                        title: 'Test Task',
                        description: 'Test Description',
                        points: 5,
                        priority: 'high',
                        folderId: newFolder.id
                    };
                    const newTask = window.app.createTask(taskData);
                    if (newTask && newTask.id) {
                        console.log('✅ Task creation works');
                        
                        // Test rendering tasks for the folder
                        try {
                            window.app.renderTasks(newFolder.id);
                            console.log('✅ Task rendering works');
                        } catch (error) {
                            console.error('❌ Task rendering failed:', error);
                        }
                        
                        // Test selecting a folder
                        try {
                            window.app.selectFolder(newFolder.id);
                            console.log('✅ Folder selection works');
                        } catch (error) {
                            console.error('❌ Folder selection failed:', error);
                        }
                    } else {
                        console.error('❌ Task creation failed');
                    }
                } else {
                    console.error('❌ Folder creation failed');
                }

                // Test notification system
                try {
                    window.app.showNotification('Test notification');
                    console.log('✅ Notification system works');
                } catch (error) {
                    console.error('❌ Notification system failed:', error);
                }

                console.log('🎉 All tests passed! New layout functionality is working correctly.');
            } else {
                console.error('❌ Some required methods are missing');
            }
        }
    </script>
</body>
</html>